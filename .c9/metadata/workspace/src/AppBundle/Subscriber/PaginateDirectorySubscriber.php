{"filter":false,"title":"PaginateDirectorySubscriber.php","tooltip":"/src/AppBundle/Subscriber/PaginateDirectorySubscriber.php","undoManager":{"mark":30,"position":30,"stack":[[{"start":{"row":0,"column":0},"end":{"row":59,"column":12},"action":"insert","lines":["<?php","","// file: ../symfony-standard/src/Acme/DemoBundle/Subscriber/PaginateDirectorySubscriber.php","// requires // Symfony\\Component\\Finder\\Finder","","namespace Acme\\DemoBundle\\Subscriber;","","use Symfony\\Component\\Finder\\Finder;","use Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;","use Knp\\Component\\Pager\\Event\\ItemsEvent;","","class PaginateDirectorySubscriber implements EventSubscriberInterface","{","    public function items(ItemsEvent $event)","    {","        if (is_string($event->target) && is_dir($event->target)) {","            $finder = new Finder;","            $finder","                ->files()","                ->depth('< 4') // 3 levels","                ->in($event->target)","            ;","            $iter = $finder->getIterator();","            $files = iterator_to_array($iter);","            $event->count = count($files);","            $event->items = array_slice(","                $files,","                $event->getOffset(),","                $event->getLimit()","            );","            $event->stopPropagation();","        }","    }","","    public static function getSubscribedEvents()","    {","        return array(","            'knp_pager.items' => array('items', 1/*increased priority to override any internal*/)","        );","    }","}","Class above is the simple event subscriber, which listens to knp_pager.items event. Creates a finder and looks in this directory for files. To be more specific it will look for the files in the directory being paginated, max in 3 level depth.","","Register subscriber as service","Next we need to tell knp_paginator about our new fancy subscriber which we intend to use in pagination. It is also very simple, create additional service config file: ../symfony-standard/src/Acme/DemoBundle/Resources/config/paginate.xml","","<?xml version=\"1.0\" ?>","","<!-- file: ../symfony-standard/src/Acme/DemoBundle/Resources/config/paginate.xml -->","","<container xmlns=\"http://symfony.com/schema/dic/services\"","    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"","    xsi:schemaLocation=\"http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd\">","","    <services>","        <service id=\"acme.directory.subscriber\" class=\"Acme\\DemoBundle\\Subscriber\\PaginateDirectorySubscriber\">","            <tag name=\"knp_paginator.subscriber\" />","        </service>","    </services>","</container>"],"id":1}],[{"start":{"row":5,"column":10},"end":{"row":5,"column":14},"action":"remove","lines":["Acme"],"id":2},{"start":{"row":5,"column":10},"end":{"row":5,"column":11},"action":"insert","lines":["s"]}],[{"start":{"row":5,"column":11},"end":{"row":5,"column":12},"action":"insert","lines":["r"],"id":3}],[{"start":{"row":5,"column":12},"end":{"row":5,"column":13},"action":"insert","lines":["c"],"id":4}],[{"start":{"row":5,"column":17},"end":{"row":5,"column":18},"action":"remove","lines":["o"],"id":5}],[{"start":{"row":5,"column":16},"end":{"row":5,"column":17},"action":"remove","lines":["m"],"id":6}],[{"start":{"row":5,"column":15},"end":{"row":5,"column":16},"action":"remove","lines":["e"],"id":7}],[{"start":{"row":5,"column":14},"end":{"row":5,"column":15},"action":"remove","lines":["D"],"id":8}],[{"start":{"row":5,"column":14},"end":{"row":5,"column":15},"action":"insert","lines":["A"],"id":9}],[{"start":{"row":5,"column":15},"end":{"row":5,"column":16},"action":"insert","lines":["p"],"id":10}],[{"start":{"row":5,"column":16},"end":{"row":5,"column":17},"action":"insert","lines":["p"],"id":11}],[{"start":{"row":55,"column":58},"end":{"row":55,"column":59},"action":"remove","lines":["e"],"id":12}],[{"start":{"row":55,"column":57},"end":{"row":55,"column":58},"action":"remove","lines":["m"],"id":13}],[{"start":{"row":55,"column":56},"end":{"row":55,"column":57},"action":"remove","lines":["c"],"id":14}],[{"start":{"row":55,"column":55},"end":{"row":55,"column":56},"action":"remove","lines":["A"],"id":15}],[{"start":{"row":55,"column":55},"end":{"row":55,"column":56},"action":"remove","lines":["\\"],"id":16}],[{"start":{"row":55,"column":58},"end":{"row":55,"column":59},"action":"remove","lines":["o"],"id":17}],[{"start":{"row":55,"column":57},"end":{"row":55,"column":58},"action":"remove","lines":["m"],"id":18}],[{"start":{"row":55,"column":56},"end":{"row":55,"column":57},"action":"remove","lines":["e"],"id":19}],[{"start":{"row":55,"column":55},"end":{"row":55,"column":56},"action":"remove","lines":["D"],"id":20}],[{"start":{"row":55,"column":55},"end":{"row":55,"column":56},"action":"insert","lines":["A"],"id":21}],[{"start":{"row":55,"column":56},"end":{"row":55,"column":57},"action":"insert","lines":["p"],"id":22}],[{"start":{"row":55,"column":57},"end":{"row":55,"column":58},"action":"insert","lines":["p"],"id":23}],[{"start":{"row":55,"column":24},"end":{"row":55,"column":25},"action":"remove","lines":["e"],"id":24}],[{"start":{"row":55,"column":23},"end":{"row":55,"column":24},"action":"remove","lines":["m"],"id":25}],[{"start":{"row":55,"column":22},"end":{"row":55,"column":23},"action":"remove","lines":["c"],"id":26}],[{"start":{"row":55,"column":21},"end":{"row":55,"column":22},"action":"remove","lines":["a"],"id":27}],[{"start":{"row":55,"column":21},"end":{"row":55,"column":22},"action":"insert","lines":["a"],"id":28}],[{"start":{"row":55,"column":22},"end":{"row":55,"column":23},"action":"insert","lines":["p"],"id":29}],[{"start":{"row":55,"column":23},"end":{"row":55,"column":24},"action":"insert","lines":["p"],"id":30}],[{"start":{"row":41,"column":0},"end":{"row":59,"column":12},"action":"remove","lines":["Class above is the simple event subscriber, which listens to knp_pager.items event. Creates a finder and looks in this directory for files. To be more specific it will look for the files in the directory being paginated, max in 3 level depth.","","Register subscriber as service","Next we need to tell knp_paginator about our new fancy subscriber which we intend to use in pagination. It is also very simple, create additional service config file: ../symfony-standard/src/Acme/DemoBundle/Resources/config/paginate.xml","","<?xml version=\"1.0\" ?>","","<!-- file: ../symfony-standard/src/Acme/DemoBundle/Resources/config/paginate.xml -->","","<container xmlns=\"http://symfony.com/schema/dic/services\"","    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"","    xsi:schemaLocation=\"http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd\">","","    <services>","        <service id=\"app.directory.subscriber\" class=\"AppBundle\\Subscriber\\PaginateDirectorySubscriber\">","            <tag name=\"knp_paginator.subscriber\" />","        </service>","    </services>","</container>"],"id":31}]]},"ace":{"folds":[],"scrolltop":312,"scrollleft":0,"selection":{"start":{"row":41,"column":0},"end":{"row":41,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1539647531961,"hash":"d203f963b610893c30f77fcccea531171056f5d5"}